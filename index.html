<!DOCTYPE html>
<html lang="hi" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    
    <!-- SEO Meta Tags -->
    <title>AI स्मार्ट अटेंडेंस सिस्टम - पंचायती राज विभाग, बिहार सरकार</title>
    <meta name="description" content="बिहार सरकार के पंचायती राज विभाग के लिए आधुनिक AI-आधारित स्मार्ट अटेंडेंस सिस्टम">
    <meta name="keywords" content="पंचायती राज, बिहार सरकार, AI अटेंडेंस, स्मार्ट अटेंडेंस, शेखपुरा जिला">
    <meta name="author" content="पंचायती राज विभाग, बिहार सरकार">
    <meta name="robots" content="index, follow">
    <meta name="theme-color" content="#1a237e">
    
    <!-- Open Graph Tags -->
    <meta property="og:title" content="AI स्मार्ट अटेंडेंस सिस्टम - पंचायती राज विभाग, बिहार सरकार">
    <meta property="og:description" content="कर्मचारियों की उपस्थिति प्रबंधन के लिए आधुनिक AI-आधारित समाधान">
    <meta property="og:type" content="website">
    <meta property="og:locale" content="hi_IN">
    
    <!-- Security Headers -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com https://fonts.googleapis.com; style-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com https://fonts.googleapis.com; font-src 'self' https://cdnjs.cloudflare.com https://fonts.gstatic.com; img-src 'self' data: https:;">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Sans+Devanagari:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Inline Critical CSS -->
    <style>
        /* ========== CRITICAL CSS ========== */
        :root {
            --primary: #1a237e;
            --primary-light: #534bae;
            --primary-dark: #000051;
            --secondary: #00695c;
            --secondary-light: #439889;
            --accent: #ff6f00;
            --success: #2e7d32;
            --warning: #f57c00;
            --danger: #c62828;
            --info: #0277bd;
            --light: #f8f9fa;
            --dark: #212121;
            --gray-100: #f5f5f5;
            --gray-200: #eeeeee;
            --gray-300: #e0e0e0;
            --gray-600: #757575;
            --gray-800: #424242;
            --shadow-sm: 0 2px 4px rgba(0,0,0,0.1);
            --shadow: 0 4px 12px rgba(0,0,0,0.15);
            --shadow-lg: 0 8px 24px rgba(0,0,0,0.2);
            --radius: 8px;
            --radius-lg: 12px;
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html {
            scroll-behavior: smooth;
            font-size: 16px;
        }
        
        body {
            font-family: 'Inter', 'Noto Sans Devanagari', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: var(--dark);
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        /* Loading Screen */
        #loadingScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary) 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }
        
        .loader {
            width: 50px;
            height: 50px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Login Page */
        #loginPage {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary) 100%);
        }
        
        .login-container {
            background: white;
            border-radius: var(--radius-lg);
            padding: 2.5rem;
            width: 100%;
            max-width: 400px;
            box-shadow: var(--shadow-lg);
            position: relative;
            overflow: hidden;
        }
        
        .login-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(90deg, var(--primary), var(--accent));
        }
        
        /* Accessibility */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        
        *:focus-visible {
            outline: 3px solid var(--accent);
            outline-offset: 2px;
        }
        
        /* Buttons Base */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 12px 24px;
            border: none;
            border-radius: var(--radius);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            text-decoration: none;
            font-family: inherit;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
        }
        
        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }
        
        .btn-block {
            width: 100%;
        }
        
        /* Form Controls */
        .form-control {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--gray-300);
            border-radius: var(--radius);
            font-size: 1rem;
            transition: var(--transition);
            background: white;
        }
        
        .form-control:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(26, 35, 126, 0.1);
        }
        
        /* Cards */
        .card {
            background: white;
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            box-shadow: var(--shadow-sm);
            transition: var(--transition);
        }
        
        .card:hover {
            box-shadow: var(--shadow);
        }
    </style>
    
    <!-- Deferred Styles -->
    <link rel="stylesheet" href="data:text/css;base64,LmFwcC1jb250YWluZXIgeyBkaXNwbGF5OiBub25lOyB9" id="deferred-styles">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen">
        <div class="loader"></div>
        <div style="color: white; text-align: center; margin-top: 1rem;">
            <h3 style="margin-bottom: 0.5rem;">पंचायती राज विभाग, बिहार</h3>
            <p>AI स्मार्ट अटेंडेंस सिस्टम</p>
        </div>
    </div>
    
    <!-- Login Page -->
    <div id="loginPage">
        <div class="login-container">
            <div style="text-align: center; margin-bottom: 2rem;">
                <div style="width: 80px; height: 80px; background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem;">
                    <i class="fas fa-landmark" style="font-size: 2.5rem; color: white;"></i>
                </div>
                <h1 style="color: var(--primary); margin-bottom: 0.5rem;">AI स्मार्ट अटेंडेंस</h1>
                <p style="color: var(--gray-600);">पंचायती राज विभाग, बिहार सरकार</p>
            </div>
            
            <form id="loginForm">
                <div style="margin-bottom: 1.5rem;">
                    <label for="username" style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--dark);">
                        <i class="fas fa-user"></i> यूजर आईडी
                    </label>
                    <input type="text" id="username" class="form-control" required placeholder="अपना यूजर आईडी डालें" autocomplete="username">
                </div>
                
                <div style="margin-bottom: 2rem;">
                    <label for="password" style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--dark);">
                        <i class="fas fa-lock"></i> पासवर्ड
                    </label>
                    <input type="password" id="password" class="form-control" required placeholder="अपना पासवर्ड डालें" autocomplete="current-password">
                </div>
                
                <button type="submit" class="btn btn-primary btn-block">
                    <i class="fas fa-sign-in-alt"></i> लॉगिन करें
                </button>
                
                <div style="margin-top: 2rem; padding: 1rem; background: var(--gray-100); border-radius: var(--radius);">
                    <p style="font-weight: 600; margin-bottom: 0.5rem; color: var(--primary);">डेमो एक्सेस:</p>
                    <p style="margin-bottom: 0.25rem;">यूजर आईडी: <code>panchayat_admin</code></p>
                    <p>पासवर्ड: <code>demo@2024</code></p>
                </div>
                
                <div style="margin-top: 1.5rem; padding: 1rem; background: #fff3cd; border: 1px solid #ffeaa7; border-radius: var(--radius);">
                    <p style="font-size: 0.875rem; color: #856404; text-align: center;">
                        <i class="fas fa-shield-alt"></i> यह डेमो संस्करण है। वास्तविक उपयोग के लिए HTTPS और सर्वर-साइड सुरक्षा जोड़ें।
                    </p>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Main App Container -->
    <div class="app-container" id="mainApp">
        <!-- Header -->
        <header style="background: white; padding: 1rem 2rem; box-shadow: var(--shadow); position: sticky; top: 0; z-index: 100;">
            <div style="display: flex; justify-content: space-between; align-items: center; max-width: 1400px; margin: 0 auto;">
                <div style="display: flex; align-items: center; gap: 1rem;">
                    <button id="menuToggle" style="background: none; border: none; font-size: 1.5rem; color: var(--primary); cursor: pointer; display: none;">
                        <i class="fas fa-bars"></i>
                    </button>
                    
                    <div style="display: flex; align-items: center; gap: 0.75rem;">
                        <div style="width: 50px; height: 50px; background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%); border-radius: 12px; display: flex; align-items: center; justify-content: center;">
                            <i class="fas fa-landmark" style="color: white; font-size: 1.5rem;"></i>
                        </div>
                        <div>
                            <h1 style="font-size: 1.25rem; color: var(--primary); margin-bottom: 0.25rem;">AI स्मार्ट अटेंडेंस</h1>
                            <p style="font-size: 0.875rem; color: var(--gray-600);">पंचायती राज विभाग, बिहार</p>
                        </div>
                    </div>
                </div>
                
                <div style="display: flex; align-items: center; gap: 1rem;">
                    <button id="notificationBtn" class="btn" style="padding: 8px; border-radius: 50%;">
                        <i class="fas fa-bell" style="color: var(--gray-600);"></i>
                    </button>
                    <button id="logoutBtn" class="btn btn-primary" style="padding: 10px 20px;">
                        <i class="fas fa-sign-out-alt"></i> लॉगआउट
                    </button>
                </div>
            </div>
        </header>
        
        <!-- Main Layout -->
        <div style="display: flex; min-height: calc(100vh - 80px); max-width: 1400px; margin: 0 auto; padding: 1rem;">
            <!-- Sidebar -->
            <aside id="sidebar" style="width: 280px; background: white; border-radius: var(--radius-lg); padding: 1.5rem; box-shadow: var(--shadow); margin-right: 1.5rem; transition: var(--transition);">
                <div style="margin-bottom: 2rem;">
                    <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 1px solid var(--gray-200);">
                        <div style="width: 60px; height: 60px; background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; color: white;">
                            <i class="fas fa-user-tie"></i>
                        </div>
                        <div>
                            <h3 id="userName" style="font-size: 1rem; margin-bottom: 0.25rem;">शेखपुरा जिला</h3>
                            <p id="userRole" style="font-size: 0.875rem; color: var(--gray-600);">पंचायती राज अधिकारी</p>
                        </div>
                    </div>
                    
                    <nav>
                        <ul style="list-style: none;">
                            <li style="margin-bottom: 0.5rem;">
                                <a href="#dashboard" class="nav-item active" data-section="dashboard" style="display: flex; align-items: center; gap: 12px; padding: 12px 16px; border-radius: var(--radius); background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%); color: white; text-decoration: none; font-weight: 500;">
                                    <i class="fas fa-tachometer-alt"></i>
                                    <span>डैशबोर्ड</span>
                                </a>
                            </li>
                            <li style="margin-bottom: 0.5rem;">
                                <a href="#attendance" class="nav-item" data-section="attendance" style="display: flex; align-items: center; gap: 12px; padding: 12px 16px; border-radius: var(--radius); color: var(--gray-800); text-decoration: none; font-weight: 500; transition: var(--transition);">
                                    <i class="fas fa-camera"></i>
                                    <span>अटेंडेंस दर्ज करें</span>
                                </a>
                            </li>
                            <li style="margin-bottom: 0.5rem;">
                                <a href="#records" class="nav-item" data-section="records" style="display: flex; align-items: center; gap: 12px; padding: 12px 16px; border-radius: var(--radius); color: var(--gray-800); text-decoration: none; font-weight: 500; transition: var(--transition);">
                                    <i class="fas fa-history"></i>
                                    <span>अटेंडेंस रिकॉर्ड</span>
                                </a>
                            </li>
                            <li style="margin-bottom: 0.5rem;">
                                <a href="#employees" class="nav-item" data-section="employees" style="display: flex; align-items: center; gap: 12px; padding: 12px 16px; border-radius: var(--radius); color: var(--gray-800); text-decoration: none; font-weight: 500; transition: var(--transition);">
                                    <i class="fas fa-users"></i>
                                    <span>कर्मचारी प्रबंधन</span>
                                </a>
                            </li>
                            <li style="margin-bottom: 0.5rem;">
                                <a href="#reports" class="nav-item" data-section="reports" style="display: flex; align-items: center; gap: 12px; padding: 12px 16px; border-radius: var(--radius); color: var(--gray-800); text-decoration: none; font-weight: 500; transition: var(--transition);">
                                    <i class="fas fa-chart-bar"></i>
                                    <span>रिपोर्ट्स एवं विश्लेषण</span>
                                </a>
                            </li>
                            <li style="margin-bottom: 0.5rem;">
                                <a href="#settings" class="nav-item" data-section="settings" style="display: flex; align-items: center; gap: 12px; padding: 12px 16px; border-radius: var(--radius); color: var(--gray-800); text-decoration: none; font-weight: 500; transition: var(--transition);">
                                    <i class="fas fa-cog"></i>
                                    <span>सेटिंग्स</span>
                                </a>
                            </li>
                        </ul>
                    </nav>
                </div>
                
                <div style="padding: 1rem; background: var(--gray-100); border-radius: var(--radius);">
                    <p style="font-weight: 600; margin-bottom: 1rem; color: var(--primary); text-align: center;">आज का सारांश</p>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                        <div style="text-align: center;">
                            <div style="font-size: 1.5rem; font-weight: 700; color: var(--success);" id="todayPresent">0</div>
                            <div style="font-size: 0.75rem; color: var(--gray-600);">उपस्थित</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 1.5rem; font-weight: 700; color: var(--danger);" id="todayAbsent">14</div>
                            <div style="font-size: 0.75rem; color: var(--gray-600);">अनुपस्थित</div>
                        </div>
                    </div>
                </div>
            </aside>
            
            <!-- Main Content -->
            <main style="flex: 1; min-width: 0;">
                <!-- Dashboard Section -->
                <section class="content-section active" id="dashboardSection" style="display: block;">
                    <div style="margin-bottom: 1.5rem;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                            <h2 style="color: var(--primary); font-size: 1.5rem;">नमस्ते, पंचायती राज अधिकारी</h2>
                            <div style="font-size: 0.875rem; color: var(--gray-600);">
                                <i class="fas fa-calendar-alt"></i> <span id="currentDate">...</span>
                            </div>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
                            <div class="card">
                                <div style="display: flex; align-items: center; gap: 1rem;">
                                    <div style="width: 50px; height: 50px; background: linear-gradient(135deg, var(--success) 0%, var(--secondary) 100%); border-radius: 12px; display: flex; align-items: center; justify-content: center;">
                                        <i class="fas fa-user-check" style="color: white; font-size: 1.25rem;"></i>
                                    </div>
                                    <div>
                                        <div style="font-size: 2rem; font-weight: 700; color: var(--success);" id="dashTodayPresent">0</div>
                                        <div style="font-size: 0.875rem; color: var(--gray-600);">आज उपस्थित</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card">
                                <div style="display: flex; align-items: center; gap: 1rem;">
                                    <div style="width: 50px; height: 50px; background: linear-gradient(135deg, var(--danger) 0%, #e53935 100%); border-radius: 12px; display: flex; align-items: center; justify-content: center;">
                                        <i class="fas fa-user-times" style="color: white; font-size: 1.25rem;"></i>
                                    </div>
                                    <div>
                                        <div style="font-size: 2rem; font-weight: 700; color: var(--danger);" id="dashTodayAbsent">14</div>
                                        <div style="font-size: 0.875rem; color: var(--gray-600);">आज अनुपस्थित</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card">
                                <div style="display: flex; align-items: center; gap: 1rem;">
                                    <div style="width: 50px; height: 50px; background: linear-gradient(135deg, var(--info) 0%, #0288d1 100%); border-radius: 12px; display: flex; align-items: center; justify-content: center;">
                                        <i class="fas fa-users" style="color: white; font-size: 1.25rem;"></i>
                                    </div>
                                    <div>
                                        <div style="font-size: 2rem; font-weight: 700; color: var(--info);" id="totalEmployees">14</div>
                                        <div style="font-size: 0.875rem; color: var(--gray-600);">कुल कर्मचारी</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card">
                                <div style="display: flex; align-items: center; gap: 1rem;">
                                    <div style="width: 50px; height: 50px; background: linear-gradient(135deg, var(--warning) 0%, #ff8f00 100%); border-radius: 12px; display: flex; align-items: center; justify-content: center;">
                                        <i class="fas fa-clock" style="color: white; font-size: 1.25rem;"></i>
                                    </div>
                                    <div>
                                        <div style="font-size: 2rem; font-weight: 700; color: var(--warning);" id="avgTime">N/A</div>
                                        <div style="font-size: 0.875rem; color: var(--gray-600);">औसत समय</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Quick Actions -->
                        <div style="margin-bottom: 2rem;">
                            <h3 style="margin-bottom: 1rem; color: var(--primary); font-size: 1.25rem;">
                                <i class="fas fa-bolt"></i> त्वरित कार्रवाई
                            </h3>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                                <button class="quick-action-btn" data-action="attendance" style="background: white; border: 2px solid var(--primary); border-radius: var(--radius); padding: 1rem; display: flex; flex-direction: column; align-items: center; gap: 0.5rem; cursor: pointer; transition: var(--transition);">
                                    <div style="width: 50px; height: 50px; background: var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                                        <i class="fas fa-camera" style="color: white; font-size: 1.25rem;"></i>
                                    </div>
                                    <span style="font-weight: 600; color: var(--primary);">अटेंडेंस दर्ज करें</span>
                                </button>
                                
                                <button class="quick-action-btn" data-action="today" style="background: white; border: 2px solid var(--success); border-radius: var(--radius); padding: 1rem; display: flex; flex-direction: column; align-items: center; gap: 0.5rem; cursor: pointer; transition: var(--transition);">
                                    <div style="width: 50px; height: 50px; background: var(--success); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                                        <i class="fas fa-calendar-day" style="color: white; font-size: 1.25rem;"></i>
                                    </div>
                                    <span style="font-weight: 600; color: var(--success);">आज का लॉग</span>
                                </button>
                                
                                <button class="quick-action-btn" data-action="export" style="background: white; border: 2px solid var(--info); border-radius: var(--radius); padding: 1rem; display: flex; flex-direction: column; align-items: center; gap: 0.5rem; cursor: pointer; transition: var(--transition);">
                                    <div style="width: 50px; height: 50px; background: var(--info); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                                        <i class="fas fa-download" style="color: white; font-size: 1.25rem;"></i>
                                    </div>
                                    <span style="font-weight: 600; color: var(--info);">डाटा डाउनलोड</span>
                                </button>
                                
                                <button class="quick-action-btn" data-action="report" style="background: white; border: 2px solid var(--warning); border-radius: var(--radius); padding: 1rem; display: flex; flex-direction: column; align-items: center; gap: 0.5rem; cursor: pointer; transition: var(--transition);">
                                    <div style="width: 50px; height: 50px; background: var(--warning); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                                        <i class="fas fa-file-export" style="color: white; font-size: 1.25rem;"></i>
                                    </div>
                                    <span style="font-weight: 600; color: var(--warning);">रिपोर्ट बनाएं</span>
                                </button>
                            </div>
                        </div>
                        
                        <!-- Recent Activity -->
                        <div class="card">
                            <h3 style="margin-bottom: 1rem; color: var(--primary); font-size: 1.25rem;">
                                <i class="fas fa-history"></i> हाल की गतिविधियाँ
                            </h3>
                            <div id="recentActivity" style="max-height: 300px; overflow-y: auto;">
                                <!-- Recent activities will be loaded here -->
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- Attendance Section -->
                <section class="content-section" id="attendanceSection" style="display: none;">
                    <div style="margin-bottom: 1.5rem;">
                        <h2 style="color: var(--primary); margin-bottom: 1.5rem; font-size: 1.5rem;">
                            <i class="fas fa-camera"></i> नई अटेंडेंस दर्ज करें
                        </h2>
                        
                        <div class="card" style="margin-bottom: 1.5rem;">
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                                <!-- Form Section -->
                                <div>
                                    <div style="margin-bottom: 1.5rem;">
                                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--dark);">कर्मचारी का नाम</label>
                                        <select id="employeeSelect" class="form-control" style="margin-bottom: 1rem;">
                                            <option value="">कृपया कर्मचारी चुनें</option>
                                        </select>
                                        
                                        <div style="margin-bottom: 1rem;">
                                            <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--dark);">विभाग</label>
                                            <input type="text" id="departmentInput" class="form-control" readonly>
                                        </div>
                                        
                                        <div style="margin-bottom: 1rem;">
                                            <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--dark);">पदनाम</label>
                                            <input type="text" id="designationInput" class="form-control" readonly>
                                        </div>
                                        
                                        <div style="margin-bottom: 1.5rem;">
                                            <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--dark);">टिप्पणी (वैकल्पिक)</label>
                                            <textarea id="commentInput" class="form-control" rows="3" placeholder="कोई टिप्पणी डालें" maxlength="500"></textarea>
                                            <div style="text-align: right; font-size: 0.875rem; color: var(--gray-600); margin-top: 0.25rem;">
                                                <span id="charCount">0</span>/500
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Location Info -->
                                    <div style="background: var(--gray-100); padding: 1rem; border-radius: var(--radius); margin-bottom: 1.5rem;">
                                        <h4 style="margin-bottom: 0.75rem; color: var(--primary); font-size: 1rem;">
                                            <i class="fas fa-map-marker-alt"></i> स्थान जानकारी
                                        </h4>
                                        <div style="display: grid; gap: 0.5rem;">
                                            <div style="display: flex; justify-content: space-between;">
                                                <span style="color: var(--gray-600);">स्थान निर्देशांक:</span>
                                                <span id="locationCoords" style="font-weight: 500;">प्राप्त करें</span>
                                            </div>
                                            <div style="display: flex; justify-content: space-between;">
                                                <span style="color: var(--gray-600);">IP पता:</span>
                                                <span id="ipAddress" style="font-weight: 500;">प्राप्त करें</span>
                                            </div>
                                            <div style="display: flex; justify-content: space-between;">
                                                <span style="color: var(--gray-600);">फोटो समय:</span>
                                                <span id="photoTime" style="font-weight: 500;">अभी तक नहीं</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Camera Section -->
                                <div>
                                    <div style="background: var(--gray-100); border-radius: var(--radius); height: 300px; display: flex; align-items: center; justify-content: center; margin-bottom: 1rem; position: relative; overflow: hidden;">
                                        <div id="cameraPlaceholder" style="text-align: center;">
                                            <i class="fas fa-camera" style="font-size: 3rem; color: var(--gray-600); margin-bottom: 1rem;"></i>
                                            <p style="color: var(--gray-600);">कैमरा यहाँ दिखेगा</p>
                                            <button id="startCameraBtn" class="btn btn-primary" style="margin-top: 1rem;">
                                                <i class="fas fa-video"></i> कैमरा शुरू करें
                                            </button>
                                        </div>
                                        <video id="videoElement" autoplay playsinline style="display: none; width: 100%; height: 100%; object-fit: cover;"></video>
                                        <canvas id="photoCanvas" style="display: none;"></canvas>
                                    </div>
                                    
                                    <div style="display: flex; gap: 1rem; margin-bottom: 1.5rem;">
                                        <button id="captureBtn" class="btn btn-primary" style="flex: 1;" disabled>
                                            <i class="fas fa-camera-retro"></i> फोटो लें
                                        </button>
                                        <button id="locationBtn" class="btn" style="flex: 1; background: var(--gray-200);">
                                            <i class="fas fa-map-marker-alt"></i> स्थान प्राप्त करें
                                        </button>
                                    </div>
                                    
                                    <div id="capturedPreview" style="display: none; text-align: center;">
                                        <p style="margin-bottom: 0.5rem; color: var(--success);">
                                            <i class="fas fa-check-circle"></i> फोटो कैप्चर हो गई
                                        </p>
                                    </div>
                                </div>
                            </div>
                            
                            <div style="display: flex; gap: 1rem;">
                                <button id="submitAttendanceBtn" class="btn btn-primary" style="flex: 1;" disabled>
                                    <i class="fas fa-check-circle"></i> अटेंडेंस दर्ज करें
                                </button>
                                <button id="cancelAttendanceBtn" class="btn" style="flex: 1; background: var(--gray-200);">
                                    <i class="fas fa-times"></i> रद्द करें
                                </button>
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- Records Section -->
                <section class="content-section" id="recordsSection" style="display: none;">
                    <div>
                        <h2 style="color: var(--primary); margin-bottom: 1.5rem; font-size: 1.5rem;">
                            <i class="fas fa-history"></i> अटेंडेंस रिकॉर्ड
                        </h2>
                        
                        <div class="card" style="margin-bottom: 1.5rem;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                                <div style="display: flex; gap: 1rem;">
                                    <input type="date" id="recordDate" class="form-control" style="width: 200px;">
                                    <button id="filterBtn" class="btn btn-primary">
                                        <i class="fas fa-filter"></i> फिल्टर
                                    </button>
                                    <button id="resetFilterBtn" class="btn" style="background: var(--gray-200);">
                                        <i class="fas fa-redo"></i>
                                    </button>
                                </div>
                                
                                <div style="display: flex; gap: 0.5rem;">
                                    <button id="exportRecordsBtn" class="btn" style="background: var(--success); color: white;">
                                        <i class="fas fa-file-export"></i> CSV
                                    </button>
                                    <button id="printRecordsBtn" class="btn" style="background: var(--info); color: white;">
                                        <i class="fas fa-print"></i> प्रिंट
                                    </button>
                                </div>
                            </div>
                            
                            <div style="overflow-x: auto;">
                                <table style="width: 100%; border-collapse: collapse;">
                                    <thead>
                                        <tr style="background: var(--gray-100);">
                                            <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--primary);">कर्मचारी</th>
                                            <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--primary);">विभाग</th>
                                            <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--primary);">समय</th>
                                            <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--primary);">स्थिति</th>
                                            <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--primary);">कार्रवाई</th>
                                        </tr>
                                    </thead>
                                    <tbody id="recordsTable">
                                        <!-- Records will be loaded here -->
                                    </tbody>
                                </table>
                            </div>
                            
                            <div id="emptyRecords" style="text-align: center; padding: 3rem; color: var(--gray-600); display: none;">
                                <i class="fas fa-clipboard" style="font-size: 3rem; margin-bottom: 1rem;"></i>
                                <p>कोई रिकॉर्ड नहीं मिला</p>
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- Employees Section -->
                <section class="content-section" id="employeesSection" style="display: none;">
                    <div>
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                            <h2 style="color: var(--primary); font-size: 1.5rem;">
                                <i class="fas fa-users"></i> कर्मचारी प्रबंधन
                            </h2>
                            <button id="addEmployeeBtn" class="btn btn-primary">
                                <i class="fas fa-plus"></i> नया कर्मचारी
                            </button>
                        </div>
                        
                        <div class="card">
                            <div style="overflow-x: auto;">
                                <table style="width: 100%; border-collapse: collapse;">
                                    <thead>
                                        <tr style="background: var(--gray-100);">
                                            <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--primary);">नाम</th>
                                            <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--primary);">विभाग</th>
                                            <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--primary);">पदनाम</th>
                                            <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--primary);">संपर्क</th>
                                            <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--primary);">कार्रवाई</th>
                                        </tr>
                                    </thead>
                                    <tbody id="employeesTable">
                                        <!-- Employees will be loaded here -->
                                    </tbody>
                                </table>
                            </div>
                            
                            <div id="emptyEmployees" style="text-align: center; padding: 3rem; color: var(--gray-600);">
                                <i class="fas fa-users" style="font-size: 3rem; margin-bottom: 1rem;"></i>
                                <p>कोई कर्मचारी नहीं मिला</p>
                                <button id="addFirstEmployeeBtn" class="btn btn-primary" style="margin-top: 1rem;">
                                    <i class="fas fa-plus"></i> पहला कर्मचारी जोड़ें
                                </button>
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- Reports Section -->
                <section class="content-section" id="reportsSection" style="display: none;">
                    <div>
                        <h2 style="color: var(--primary); margin-bottom: 1.5rem; font-size: 1.5rem;">
                            <i class="fas fa-chart-bar"></i> रिपोर्ट्स एवं विश्लेषण
                        </h2>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
                            <div class="card">
                                <div style="margin-bottom: 1rem;">
                                    <div style="width: 60px; height: 60px; background: linear-gradient(135deg, var(--success) 0%, var(--secondary) 100%); border-radius: 12px; display: flex; align-items: center; justify-content: center; margin-bottom: 1rem;">
                                        <i class="fas fa-calendar-day" style="color: white; font-size: 1.5rem;"></i>
                                    </div>
                                    <h3 style="margin-bottom: 0.5rem; color: var(--dark);">दैनिक रिपोर्ट</h3>
                                    <p style="color: var(--gray-600); font-size: 0.875rem; margin-bottom: 1rem;">आज की विस्तृत अटेंडेंस रिपोर्ड</p>
                                    <button class="report-btn btn-primary" data-type="daily" style="width: 100%;">
                                        <i class="fas fa-download"></i> डाउनलोड करें
                                    </button>
                                </div>
                            </div>
                            
                            <div class="card">
                                <div style="margin-bottom: 1rem;">
                                    <div style="width: 60px; height: 60px; background: linear-gradient(135deg, var(--info) 0%, #0288d1 100%); border-radius: 12px; display: flex; align-items: center; justify-content: center; margin-bottom: 1rem;">
                                        <i class="fas fa-calendar-alt" style="color: white; font-size: 1.5rem;"></i>
                                    </div>
                                    <h3 style="margin-bottom: 0.5rem; color: var(--dark);">मासिक रिपोर्ट</h3>
                                    <p style="color: var(--gray-600); font-size: 0.875rem; margin-bottom: 1rem;">इस महीने की अटेंडेंस रिपोर्ट</p>
                                    <button class="report-btn btn-primary" data-type="monthly" style="width: 100%;">
                                        <i class="fas fa-download"></i> डाउनलोड करें
                                    </button>
                                </div>
                            </div>
                            
                            <div class="card">
                                <div style="margin-bottom: 1rem;">
                                    <div style="width: 60px; height: 60px; background: linear-gradient(135deg, var(--warning) 0%, #ff8f00 100%); border-radius: 12px; display: flex; align-items: center; justify-content: center; margin-bottom: 1rem;">
                                        <i class="fas fa-building" style="color: white; font-size: 1.5rem;"></i>
                                    </div>
                                    <h3 style="margin-bottom: 0.5rem; color: var(--dark);">विभागवार रिपोर्ट</h3>
                                    <p style="color: var(--gray-600); font-size: 0.875rem; margin-bottom: 1rem;">प्रत्येक विभाग की विस्तृत रिपोर्ट</p>
                                    <button class="report-btn btn-primary" data-type="department" style="width: 100%;">
                                        <i class="fas fa-download"></i> डाउनलोड करें
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Statistics Chart -->
                        <div class="card">
                            <h3 style="margin-bottom: 1rem; color: var(--primary); font-size: 1.25rem;">अटेंडेंस सांख्यिकी</h3>
                            <div style="height: 300px; display: flex; align-items: center; justify-content: center; background: var(--gray-100); border-radius: var(--radius);">
                                <div id="attendanceChart" style="width: 100%; height: 100%; padding: 1rem;">
                                    <!-- Chart will be rendered here -->
                                    <div style="text-align: center; color: var(--gray-600);">
                                        <i class="fas fa-chart-pie" style="font-size: 3rem; margin-bottom: 1rem;"></i>
                                        <p>सांख्यिकी चार्ट यहाँ दिखेगा</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- Settings Section -->
                <section class="content-section" id="settingsSection" style="display: none;">
                    <div>
                        <h2 style="color: var(--primary); margin-bottom: 1.5rem; font-size: 1.5rem;">
                            <i class="fas fa-cog"></i> सेटिंग्स
                        </h2>
                        
                        <div class="card" style="max-width: 600px;">
                            <form id="settingsForm">
                                <div style="margin-bottom: 1.5rem;">
                                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--dark);">सिस्टम भाषा</label>
                                    <select id="languageSelect" class="form-control">
                                        <option value="hi">हिंदी</option>
                                        <option value="en">English</option>
                                    </select>
                                </div>
                                
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 1.5rem;">
                                    <div>
                                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--dark);">अटेंडेंस शुरू समय</label>
                                        <input type="time" id="startTime" class="form-control" value="09:00">
                                    </div>
                                    <div>
                                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--dark);">अटेंडेंस समाप्ति समय</label>
                                        <input type="time" id="endTime" class="form-control" value="17:00">
                                    </div>
                                </div>
                                
                                <div style="margin-bottom: 2rem;">
                                    <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
                                        <input type="checkbox" id="enableNotifications" checked>
                                        <label for="enableNotifications" style="font-weight: 500;">पुश नोटिफिकेशन सक्षम करें</label>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
                                        <input type="checkbox" id="enableCamera" checked>
                                        <label for="enableCamera" style="font-weight: 500;">कैमरा सुविधा सक्षम करें</label>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <input type="checkbox" id="enableLocation" checked>
                                        <label for="enableLocation" style="font-weight: 500;">स्थान ट्रैकिंग सक्षम करें</label>
                                    </div>
                                </div>
                                
                                <div style="display: flex; gap: 1rem;">
                                    <button type="button" id="saveSettingsBtn" class="btn btn-primary" style="flex: 1;">
                                        <i class="fas fa-save"></i> सेटिंग्स सहेजें
                                    </button>
                                    <button type="button" id="resetSettingsBtn" class="btn" style="flex: 1; background: var(--gray-200);">
                                        <i class="fas fa-redo"></i> डिफ़ॉल्ट रीसेट
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </section>
            </main>
        </div>
    </div>
    
    <!-- Modal for Employee Management -->
    <div id="employeeModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; align-items: center; justify-content: center;">
        <div style="background: white; border-radius: var(--radius-lg); padding: 2rem; width: 90%; max-width: 500px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                <h3 style="color: var(--primary); font-size: 1.25rem;" id="modalTitle">नया कर्मचारी</h3>
                <button id="closeModalBtn" style="background: none; border: none; font-size: 1.25rem; cursor: pointer; color: var(--gray-600);">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="employeeForm">
                <input type="hidden" id="employeeId">
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--dark);">नाम</label>
                    <input type="text" id="modalEmployeeName" class="form-control" required>
                </div>
                
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--dark);">विभाग</label>
                    <select id="modalEmployeeDepartment" class="form-control" required>
                        <option value="पंचायती राज विभाग">पंचायती राज विभाग</option>
                    </select>
                </div>
                
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--dark);">पदनाम</label>
                    <input type="text" id="modalEmployeeDesignation" class="form-control" required>
                </div>
                
                <div style="margin-bottom: 1.5rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--dark);">संपर्क नंबर</label>
                    <input type="tel" id="modalEmployeeContact" class="form-control" pattern="[0-9]{10}">
                </div>
                
                <button type="submit" class="btn btn-primary" style="width: 100%;">
                    <i class="fas fa-save"></i> सहेजें
                </button>
            </form>
        </div>
    </div>
    
    <!-- Notification Container -->
    <div id="notificationContainer" style="position: fixed; top: 20px; right: 20px; z-index: 1001;"></div>
    
    <!-- JavaScript -->
    <script>
        // ========== CONFIGURATION ==========
        const CONFIG = {
            APP_VERSION: '5.1',
            DEMO_CREDENTIALS: {
                username: 'panchayat_admin',
                password: 'demo@2024'
            },
            DEFAULT_SETTINGS: {
                language: 'hi',
                startTime: '09:00',
                endTime: '17:00',
                enableNotifications: true,
                enableCamera: true,
                enableLocation: true
            }
        };
        
        // ========== STATE MANAGEMENT ==========
        const AppState = {
            isAuthenticated: false,
            currentSection: 'dashboard',
            videoStream: null,
            capturedPhoto: null,
            currentLocation: null,
            currentIP: null,
            
            // Data
            employees: [],
            attendanceRecords: [],
            settings: {},
            
            // Initialize
            init() {
                this.loadData();
                this.loadSettings();
                this.initEventListeners();
                this.updateUI();
                this.hideLoading();
            },
            
            loadData() {
                try {
                    const saved = localStorage.getItem('panchayat_attendance_data');
                    if (saved) {
                        const data = JSON.parse(saved);
                        this.employees = data.employees || this.getSampleEmployees();
                        this.attendanceRecords = data.attendanceRecords || [];
                    } else {
                        this.employees = this.getSampleEmployees();
                        this.attendanceRecords = this.getSampleAttendance();
                    }
                } catch (error) {
                    console.error('Data loading error:', error);
                    this.employees = this.getSampleEmployees();
                    this.attendanceRecords = this.getSampleAttendance();
                }
            },
            
            loadSettings() {
                try {
                    const saved = localStorage.getItem('panchayat_settings');
                    this.settings = saved ? JSON.parse(saved) : {...CONFIG.DEFAULT_SETTINGS};
                } catch (error) {
                    this.settings = {...CONFIG.DEFAULT_SETTINGS};
                }
            },
            
            saveData() {
                const data = {
                    employees: this.employees,
                    attendanceRecords: this.attendanceRecords,
                    lastUpdated: new Date().toISOString()
                };
                localStorage.setItem('panchayat_attendance_data', JSON.stringify(data));
            },
            
            saveSettings() {
                localStorage.setItem('panchayat_settings', JSON.stringify(this.settings));
            },
            
            getSampleEmployees() {
                return [
                    { id: 1, name: 'AMRENDRA KUMAR', department: 'पंचायती राज विभाग', designation: 'DATA ENTRY OPERATOR', contact: '1234567890' },
                    { id: 2, name: 'SULOK KUMAR', department: 'पंचायती राज विभाग', designation: 'DATA ENTRY OPERATOR', contact: '9876543210' },
                    { id: 3, name: 'DHIRAJ KUMAR', department: 'पंचायती राज विभाग', designation: 'DATA ENTRY OPERATOR', contact: '8765432109' },
                    { id: 4, name: 'DEEPAK KUMAR SINGH', department: 'पंचायती राज विभाग', designation: 'DATA ENTRY OPERATOR', contact: '7654321098' },
                    { id: 5, name: 'SANGEETA KUMARI', department: 'पंचायती राज विभाग', designation: 'DATA ENTRY OPERATOR', contact: '6543210987' },
                    { id: 6, name: 'PRATIMA KUMARI', department: 'पंचायती राज विभाग', designation: 'DATA ENTRY OPERATOR', contact: '5432109876' },
                    { id: 7, name: 'JULI KUMARI', department: 'पंचायती राज विभाग', designation: 'DATA ENTRY OPERATOR', contact: '4321098765' },
                    { id: 8, name: 'SHIREEN TARRANUM', department: 'पंचायती राज विभाग', designation: 'DATA ENTRY OPERATOR', contact: '3210987654' },
                    { id: 9, name: 'AVINASH KUMAR', department: 'पंचायती राज विभाग', designation: 'DATA ENTRY OPERATOR', contact: '2109876543' },
                    { id: 10, name: 'RAJVARDHAN SHARMA', department: 'पंचायती राज विभाग', designation: 'DATA ENTRY OPERATOR', contact: '1098765432' },
                    { id: 11, name: 'CHANDAN KUMAR', department: 'पंचायती राज विभाग', designation: 'DATA ENTRY OPERATOR', contact: '0987654321' },
                    { id: 12, name: 'JACKY KUMAR', department: 'पंचायती राज विभाग', designation: 'DATA ENTRY OPERATOR', contact: '9876543210' },
                    { id: 13, name: 'DEEPAK KUMAR', department: 'पंचायती राज विभाग', designation: 'DATA ENTRY OPERATOR', contact: '8765432109' },
                    { id: 14, name: 'BEAUTY KUMARI', department: 'पंचायती राज विभाग', designation: 'DATA ENTRY OPERATOR', contact: '7654321098' }
                ];
            },
            
            getSampleAttendance() {
                const today = new Date().toISOString().split('T')[0];
                return [
                    {
                        id: Date.now(),
                        employeeId: 1,
                        name: 'AMRENDRA KUMAR',
                        department: 'पंचायती राज विभाग',
                        designation: 'DATA ENTRY OPERATOR',
                        time: '09:15 AM',
                        date: today,
                        status: 'present',
                        comment: 'समय पर उपस्थित',
                        location: '25.5941, 85.1376',
                        ip: '192.168.1.1',
                        photoTime: '09:15 AM'
                    }
                ];
            }
        };
        
        // ========== UI CONTROLLER ==========
        const UIController = {
            init() {
                this.updateDate();
                this.updateEmployeeSelect();
                this.updateEmployeesTable();
                this.updateRecordsTable();
                this.updateDashboardStats();
                this.setupResponsive();
            },
            
            updateDate() {
                const now = new Date();
                const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
                document.getElementById('currentDate').textContent = now.toLocaleDateString('hi-IN', options);
            },
            
            updateEmployeeSelect() {
                const select = document.getElementById('employeeSelect');
                select.innerHTML = '<option value="">कृपया कर्मचारी चुनें</option>';
                
                AppState.employees.forEach(employee => {
                    const option = document.createElement('option');
                    option.value = employee.id;
                    option.textContent = employee.name;
                    select.appendChild(option);
                });
            },
            
            updateEmployeesTable() {
                const tbody = document.getElementById('employeesTable');
                const emptyState = document.getElementById('emptyEmployees');
                
                if (AppState.employees.length === 0) {
                    tbody.innerHTML = '';
                    emptyState.style.display = 'block';
                    return;
                }
                
                emptyState.style.display = 'none';
                tbody.innerHTML = AppState.employees.map(employee => `
                    <tr>
                        <td style="padding: 12px; border-bottom: 1px solid var(--gray-200);">
                            <div style="display: flex; align-items: center; gap: 0.75rem;">
                                <div style="width: 40px; height: 40px; background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: 600; font-size: 0.875rem;">
                                    ${employee.name.split(' ').map(n => n[0]).join('').substring(0, 2)}
                                </div>
                                <span style="font-weight: 500;">${employee.name}</span>
                            </div>
                        </td>
                        <td style="padding: 12px; border-bottom: 1px solid var(--gray-200);">${employee.department}</td>
                        <td style="padding: 12px; border-bottom: 1px solid var(--gray-200);">${employee.designation}</td>
                        <td style="padding: 12px; border-bottom: 1px solid var(--gray-200);">${employee.contact}</td>
                        <td style="padding: 12px; border-bottom: 1px solid var(--gray-200);">
                            <div style="display: flex; gap: 0.5rem;">
                                <button class="edit-employee-btn" data-id="${employee.id}" style="padding: 6px 12px; background: var(--info); color: white; border: none; border-radius: 4px; cursor: pointer;">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="delete-employee-btn" data-id="${employee.id}" style="padding: 6px 12px; background: var(--danger); color: white; border: none; border-radius: 4px; cursor: pointer;">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                `).join('');
            },
            
            updateRecordsTable() {
                const tbody = document.getElementById('recordsTable');
                const emptyState = document.getElementById('emptyRecords');
                const filterDate = document.getElementById('recordDate').value;
                
                let records = AppState.attendanceRecords;
                if (filterDate) {
                    records = records.filter(record => record.date === filterDate);
                }
                
                if (records.length === 0) {
                    tbody.innerHTML = '';
                    emptyState.style.display = 'block';
                    return;
                }
                
                emptyState.style.display = 'none';
                tbody.innerHTML = records.map((record, index) => `
                    <tr>
                        <td style="padding: 12px; border-bottom: 1px solid var(--gray-200);">
                            <div style="display: flex; align-items: center; gap: 0.75rem;">
                                <div style="width: 40px; height: 40px; background: ${record.status === 'present' ? 'var(--success)' : 'var(--danger)'}; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: 600; font-size: 0.875rem;">
                                    ${record.name.split(' ').map(n => n[0]).join('').substring(0, 2)}
                                </div>
                                <div>
                                    <div style="font-weight: 500;">${record.name}</div>
                                    <div style="font-size: 0.875rem; color: var(--gray-600);">${record.designation}</div>
                                </div>
                            </div>
                        </td>
                        <td style="padding: 12px; border-bottom: 1px solid var(--gray-200);">${record.department}</td>
                        <td style="padding: 12px; border-bottom: 1px solid var(--gray-200);">${record.time}</td>
                        <td style="padding: 12px; border-bottom: 1px solid var(--gray-200);">
                            <span style="padding: 4px 12px; background: ${record.status === 'present' ? '#e8f5e9' : '#ffebee'}; color: ${record.status === 'present' ? 'var(--success)' : 'var(--danger)'}; border-radius: 20px; font-size: 0.875rem; font-weight: 600;">
                                ${record.status === 'present' ? 'उपस्थित' : 'अनुपस्थित'}
                            </span>
                        </td>
                        <td style="padding: 12px; border-bottom: 1px solid var(--gray-200);">
                            <button class="view-record-btn" data-id="${record.id}" style="padding: 6px 12px; background: var(--primary); color: white; border: none; border-radius: 4px; cursor: pointer;">
                                <i class="fas fa-eye"></i>
                            </button>
                        </td>
                    </tr>
                `).join('');
            },
            
            updateDashboardStats() {
                const today = new Date().toISOString().split('T')[0];
                const todayRecords = AppState.attendanceRecords.filter(r => r.date === today);
                const presentToday = todayRecords.filter(r => r.status === 'present').length;
                const totalEmployees = AppState.employees.length;
                
                // Update dashboard
                document.getElementById('todayPresent').textContent = presentToday;
                document.getElementById('dashTodayPresent').textContent = presentToday;
                document.getElementById('todayAbsent').textContent = totalEmployees - presentToday;
                document.getElementById('dashTodayAbsent').textContent = totalEmployees - presentToday;
                document.getElementById('totalEmployees').textContent = totalEmployees;
                
                // Update average time
                if (presentToday > 0) {
                    const times = todayRecords.map(r => {
                        const [time, period] = r.time.split(' ');
                        let [hours, minutes] = time.split(':').map(Number);
                        if (period === 'PM' && hours < 12) hours += 12;
                        if (period === 'AM' && hours === 12) hours = 0;
                        return hours * 60 + minutes;
                    });
                    
                    const avg = times.reduce((a, b) => a + b, 0) / times.length;
                    const avgHours = Math.floor(avg / 60);
                    const avgMins = Math.floor(avg % 60);
                    const period = avgHours >= 12 ? 'PM' : 'AM';
                    const displayHours = avgHours > 12 ? avgHours - 12 : avgHours;
                    
                    document.getElementById('avgTime').textContent = 
                        `${displayHours}:${avgMins.toString().padStart(2, '0')} ${period}`;
                }
                
                // Update recent activity
                this.updateRecentActivity();
            },
            
            updateRecentActivity() {
                const container = document.getElementById('recentActivity');
                const recent = AppState.attendanceRecords.slice(0, 5);
                
                container.innerHTML = recent.map(record => `
                    <div style="display: flex; align-items: center; gap: 1rem; padding: 12px; border-bottom: 1px solid var(--gray-200);">
                        <div style="width: 40px; height: 40px; background: ${record.status === 'present' ? 'var(--success)' : 'var(--danger)'}; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white;">
                            <i class="fas fa-user"></i>
                        </div>
                        <div style="flex: 1;">
                            <div style="font-weight: 500;">${record.name}</div>
                            <div style="font-size: 0.875rem; color: var(--gray-600);">${record.time} • ${record.status === 'present' ? 'उपस्थित' : 'अनुपस्थित'}</div>
                        </div>
                        <div style="font-size: 0.875rem; color: var(--gray-600);">
                            ${record.date}
                        </div>
                    </div>
                `).join('');
            },
            
            setupResponsive() {
                const menuToggle = document.getElementById('menuToggle');
                const sidebar = document.getElementById('sidebar');
                
                if (window.innerWidth < 1024) {
                    sidebar.style.display = 'none';
                    menuToggle.style.display = 'block';
                } else {
                    sidebar.style.display = 'block';
                    menuToggle.style.display = 'none';
                }
                
                window.addEventListener('resize', () => {
                    if (window.innerWidth < 1024) {
                        sidebar.style.display = 'none';
                        menuToggle.style.display = 'block';
                    } else {
                        sidebar.style.display = 'block';
                        menuToggle.style.display = 'none';
                    }
                });
            },
            
            showNotification(message, type = 'info') {
                const container = document.getElementById('notificationContainer');
                const notification = document.createElement('div');
                
                let bgColor = 'var(--info)';
                if (type === 'success') bgColor = 'var(--success)';
                if (type === 'error') bgColor = 'var(--danger)';
                if (type === 'warning') bgColor = 'var(--warning)';
                
                notification.innerHTML = `
                    <div style="background: white; border-left: 4px solid ${bgColor}; padding: 1rem; border-radius: var(--radius); box-shadow: var(--shadow); margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.75rem; animation: slideIn 0.3s ease;">
                        <div style="width: 32px; height: 32px; background: ${bgColor}; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white;">
                            <i class="fas fa-${type === 'success' ? 'check' : type === 'error' ? 'exclamation' : type === 'warning' ? 'exclamation-triangle' : 'info'}"></i>
                        </div>
                        <div>${message}</div>
                    </div>
                `;
                
                container.appendChild(notification);
                
                setTimeout(() => {
                    notification.style.opacity = '0';
                    notification.style.transform = 'translateX(100%)';
                    setTimeout(() => notification.remove(), 300);
                }, 5000);
            },
            
            showSection(section) {
                // Hide all sections
                document.querySelectorAll('.content-section').forEach(el => {
                    el.style.display = 'none';
                });
                
                // Remove active class from all nav items
                document.querySelectorAll('.nav-item').forEach(el => {
                    el.classList.remove('active');
                    el.style.background = '';
                    el.style.color = '';
                });
                
                // Show selected section
                document.getElementById(section + 'Section').style.display = 'block';
                
                // Update active nav item
                const activeNav = document.querySelector(`.nav-item[data-section="${section}"]`);
                if (activeNav) {
                    activeNav.classList.add('active');
                    activeNav.style.background = 'linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%)';
                    activeNav.style.color = 'white';
                }
                
                // Close sidebar on mobile
                if (window.innerWidth < 1024) {
                    document.getElementById('sidebar').style.display = 'none';
                }
                
                AppState.currentSection = section;
                
                // Refresh section data
                switch(section) {
                    case 'attendance':
                        this.updateEmployeeSelect();
                        break;
                    case 'records':
                        this.updateRecordsTable();
                        break;
                    case 'employees':
                        this.updateEmployeesTable();
                        break;
                    case 'dashboard':
                        this.updateDashboardStats();
                        break;
                }
            }
        };
        
        // ========== EVENT HANDLERS ==========
        const EventHandlers = {
            init() {
                // Login form
                document.getElementById('loginForm').addEventListener('submit', this.handleLogin.bind(this));
                
                // Logout
                document.getElementById('logoutBtn').addEventListener('click', this.handleLogout.bind(this));
                
                // Navigation
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.addEventListener('click', (e) => {
                        e.preventDefault();
                        const section = e.currentTarget.dataset.section;
                        UIController.showSection(section);
                    });
                });
                
                // Menu toggle
                document.getElementById('menuToggle').addEventListener('click', () => {
                    const sidebar = document.getElementById('sidebar');
                    sidebar.style.display = sidebar.style.display === 'none' ? 'block' : 'none';
                });
                
                // Quick actions
                document.querySelectorAll('.quick-action-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const action = e.currentTarget.dataset.action;
                        this.handleQuickAction(action);
                    });
                });
                
                // Attendance section
                this.setupAttendanceHandlers();
                
                // Records section
                this.setupRecordsHandlers();
                
                // Employees section
                this.setupEmployeesHandlers();
                
                // Reports section
                this.setupReportsHandlers();
                
                // Settings section
                this.setupSettingsHandlers();
            },
            
            handleLogin(e) {
                e.preventDefault();
                
                const username = document.getElementById('username').value;
                const password = document.getElementById('password').value;
                
                if (username === CONFIG.DEMO_CREDENTIALS.username && 
                    password === CONFIG.DEMO_CREDENTIALS.password) {
                    
                    AppState.isAuthenticated = true;
                    document.getElementById('loginPage').style.display = 'none';
                    document.getElementById('mainApp').style.display = 'block';
                    UIController.init();
                    UIController.showNotification('सफलतापूर्वक लॉगिन हो गया!', 'success');
                    
                } else {
                    UIController.showNotification('गलत यूजर आईडी या पासवर्ड', 'error');
                }
            },
            
            handleLogout() {
                if (confirm('क्या आप वाकई लॉगआउट करना चाहते हैं?')) {
                    AppState.isAuthenticated = false;
                    document.getElementById('mainApp').style.display = 'none';
                    document.getElementById('loginPage').style.display = 'flex';
                    document.getElementById('loginForm').reset();
                    UIController.showNotification('सफलतापूर्वक लॉगआउट हो गया', 'success');
                }
            },
            
            handleQuickAction(action) {
                switch(action) {
                    case 'attendance':
                        UIController.showSection('attendance');
                        break;
                    case 'today':
                        UIController.showSection('records');
                        document.getElementById('recordDate').valueAsDate = new Date();
                        UIController.updateRecordsTable();
                        break;
                    case 'export':
                        this.exportData();
                        break;
                    case 'report':
                        UIController.showSection('reports');
                        break;
                }
            },
            
            setupAttendanceHandlers() {
                const employeeSelect = document.getElementById('employeeSelect');
                const commentInput = document.getElementById('commentInput');
                const startCameraBtn = document.getElementById('startCameraBtn');
                const captureBtn = document.getElementById('captureBtn');
                const locationBtn = document.getElementById('locationBtn');
                const submitBtn = document.getElementById('submitAttendanceBtn');
                const cancelBtn = document.getElementById('cancelAttendanceBtn');
                
                // Employee selection
                employeeSelect.addEventListener('change', (e) => {
                    const employeeId = e.target.value;
                    if (employeeId) {
                        const employee = AppState.employees.find(emp => emp.id == employeeId);
                        if (employee) {
                            document.getElementById('departmentInput').value = employee.department;
                            document.getElementById('designationInput').value = employee.designation;
                        }
                    }
                });
                
                // Character count
                commentInput.addEventListener('input', (e) => {
                    document.getElementById('charCount').textContent = e.target.value.length;
                });
                
                // Camera handling
                startCameraBtn.addEventListener('click', async () => {
                    try {
                        if (!AppState.settings.enableCamera) {
                            UIController.showNotification('कैमरा सुविधा अक्षम है', 'warning');
                            return;
                        }
                        
                        const stream = await navigator.mediaDevices.getUserMedia({
                            video: { facingMode: 'user' }
                        });
                        
                        AppState.videoStream = stream;
                        const video = document.getElementById('videoElement');
                        video.srcObject = stream;
                        video.style.display = 'block';
                        document.getElementById('cameraPlaceholder').style.display = 'none';
                        captureBtn.disabled = false;
                        
                        startCameraBtn.innerHTML = '<i class="fas fa-stop"></i> कैमरा बंद करें';
                        startCameraBtn.onclick = () => this.stopCamera();
                        
                    } catch (error) {
                        console.error('Camera error:', error);
                        UIController.showNotification('कैमरा एक्सेस अस्वीकृत', 'error');
                    }
                });
                
                // Photo capture
                captureBtn.addEventListener('click', () => {
                    const video = document.getElementById('videoElement');
                    const canvas = document.getElementById('photoCanvas');
                    const context = canvas.getContext('2d');
                    
                    canvas.width = video.videoWidth;
                    canvas.height = video.videoHeight;
                    context.drawImage(video, 0, 0, canvas.width, canvas.height);
                    
                    // Add watermark
                    context.font = '16px Arial';
                    context.fillStyle = 'rgba(255,255,255,0.7)';
                    context.fillRect(0, 0, canvas.width, 30);
                    context.fillStyle = '#000';
                    context.fillText(`पंचायती राज विभाग - ${new Date().toLocaleString('hi-IN')}`, 10, 20);
                    
                    AppState.capturedPhoto = canvas.toDataURL('image/jpeg');
                    document.getElementById('photoTime').textContent = new Date().toLocaleTimeString('hi-IN');
                    document.getElementById('capturedPreview').style.display = 'block';
                    submitBtn.disabled = false;
                    
                    UIController.showNotification('फोटो कैप्चर हो गई', 'success');
                });
                
                // Location
                locationBtn.addEventListener('click', () => {
                    if (!AppState.settings.enableLocation) {
                        UIController.showNotification('स्थान ट्रैकिंग अक्षम है', 'warning');
                        return;
                    }
                    
                    if (navigator.geolocation) {
                        navigator.geolocation.getCurrentPosition(
                            (position) => {
                                AppState.currentLocation = {
                                    lat: position.coords.latitude,
                                    lng: position.coords.longitude
                                };
                                document.getElementById('locationCoords').textContent = 
                                    `${position.coords.latitude.toFixed(6)}, ${position.coords.longitude.toFixed(6)}`;
                                UIController.showNotification('स्थान प्राप्त हो गया', 'success');
                            },
                            (error) => {
                                console.error('Geolocation error:', error);
                                UIController.showNotification('स्थान प्राप्त नहीं हो सका', 'error');
                            }
                        );
                    }
                });
                
                // Submit attendance
                submitBtn.addEventListener('click', () => {
                    const employeeId = employeeSelect.value;
                    if (!employeeId) {
                        UIController.showNotification('कृपया कर्मचारी चुनें', 'error');
                        return;
                    }
                    
                    const employee = AppState.employees.find(emp => emp.id == employeeId);
                    const now = new Date();
                    
                    const record = {
                        id: Date.now(),
                        employeeId: parseInt(employeeId),
                        name: employee.name,
                        department: employee.department,
                        designation: employee.designation,
                        time: now.toLocaleTimeString('hi-IN', {hour: '2-digit', minute:'2-digit'}),
                        date: now.toISOString().split('T')[0],
                        status: 'present',
                        comment: commentInput.value,
                        location: AppState.currentLocation ? 
                            `${AppState.currentLocation.lat}, ${AppState.currentLocation.lng}` : 'N/A',
                        ip: AppState.currentIP || 'N/A',
                        photoTime: document.getElementById('photoTime').textContent
                    };
                    
                    AppState.attendanceRecords.unshift(record);
                    AppState.saveData();
                    UIController.updateDashboardStats();
                    UIController.showNotification(`${employee.name} की अटेंडेंस दर्ज हो गई`, 'success');
                    
                    // Reset form
                    this.resetAttendanceForm();
                    UIController.showSection('dashboard');
                });
                
                // Cancel
                cancelBtn.addEventListener('click', () => {
                    this.resetAttendanceForm();
                    UIController.showSection('dashboard');
                });
            },
            
            stopCamera() {
                if (AppState.videoStream) {
                    AppState.videoStream.getTracks().forEach(track => track.stop());
                    AppState.videoStream = null;
                }
                
                document.getElementById('videoElement').style.display = 'none';
                document.getElementById('cameraPlaceholder').style.display = 'block';
                document.getElementById('captureBtn').disabled = true;
                
                const startBtn = document.getElementById('startCameraBtn');
                startBtn.innerHTML = '<i class="fas fa-video"></i> कैमरा शुरू करें';
                startBtn.onclick = () => this.setupAttendanceHandlers();
            },
            
            resetAttendanceForm() {
                document.getElementById('employeeSelect').value = '';
                document.getElementById('departmentInput').value = '';
                document.getElementById('designationInput').value = '';
                document.getElementById('commentInput').value = '';
                document.getElementById('charCount').textContent = '0';
                document.getElementById('locationCoords').textContent = 'प्राप्त करें';
                document.getElementById('photoTime').textContent = 'अभी तक नहीं';
                document.getElementById('capturedPreview').style.display = 'none';
                document.getElementById('submitAttendanceBtn').disabled = true;
                
                this.stopCamera();
            },
            
            setupRecordsHandlers() {
                document.getElementById('filterBtn').addEventListener('click', () => {
                    UIController.updateRecordsTable();
                });
                
                document.getElementById('resetFilterBtn').addEventListener('click', () => {
                    document.getElementById('recordDate').value = '';
                    UIController.updateRecordsTable();
                });
                
                document.getElementById('exportRecordsBtn').addEventListener('click', () => {
                    this.exportRecords();
                });
                
                document.getElementById('printRecordsBtn').addEventListener('click', () => {
                    window.print();
                });
            },
            
            setupEmployeesHandlers() {
                const modal = document.getElementById('employeeModal');
                const closeBtn = document.getElementById('closeModalBtn');
                const form = document.getElementById('employeeForm');
                
                // Add employee buttons
                document.getElementById('addEmployeeBtn').addEventListener('click', () => this.showEmployeeModal());
                document.getElementById('addFirstEmployeeBtn').addEventListener('click', () => this.showEmployeeModal());
                
                // Close modal
                closeBtn.addEventListener('click', () => {
                    modal.style.display = 'none';
                });
                
                // Form submission
                form.addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.saveEmployee();
                });
                
                // Event delegation for edit/delete
                document.addEventListener('click', (e) => {
                    if (e.target.closest('.edit-employee-btn')) {
                        const id = e.target.closest('.edit-employee-btn').dataset.id;
                        this.editEmployee(id);
                    }
                    
                    if (e.target.closest('.delete-employee-btn')) {
                        const id = e.target.closest('.delete-employee-btn').dataset.id;
                        this.deleteEmployee(id);
                    }
                });
            },
            
            showEmployeeModal(employee = null) {
                const modal = document.getElementById('employeeModal');
                const title = document.getElementById('modalTitle');
                
                if (employee) {
                    title.textContent = 'कर्मचारी संपादित करें';
                    document.getElementById('employeeId').value = employee.id;
                    document.getElementById('modalEmployeeName').value = employee.name;
                    document.getElementById('modalEmployeeDepartment').value = employee.department;
                    document.getElementById('modalEmployeeDesignation').value = employee.designation;
                    document.getElementById('modalEmployeeContact').value = employee.contact;
                } else {
                    title.textContent = 'नया कर्मचारी जोड़ें';
                    form.reset();
                    document.getElementById('employeeId').value = '';
                }
                
                modal.style.display = 'flex';
            },
            
            editEmployee(id) {
                const employee = AppState.employees.find(emp => emp.id == id);
                if (employee) {
                    this.showEmployeeModal(employee);
                }
            },
            
            deleteEmployee(id) {
                if (confirm('क्या आप वाकई इस कर्मचारी को हटाना चाहते हैं?')) {
                    AppState.employees = AppState.employees.filter(emp => emp.id != id);
                    AppState.saveData();
                    UIController.updateEmployeesTable();
                    UIController.updateDashboardStats();
                    UIController.showNotification('कर्मचारी हटा दिया गया', 'success');
                }
            },
            
            saveEmployee() {
                const id = document.getElementById('employeeId').value;
                const name = document.getElementById('modalEmployeeName').value;
                const department = document.getElementById('modalEmployeeDepartment').value;
                const designation = document.getElementById('modalEmployeeDesignation').value;
                const contact = document.getElementById('modalEmployeeContact').value;
                
                if (!name || !department || !designation) {
                    UIController.showNotification('कृपया सभी आवश्यक फील्ड भरें', 'error');
                    return;
                }
                
                if (id) {
                    // Update existing
                    const index = AppState.employees.findIndex(emp => emp.id == id);
                    if (index !== -1) {
                        AppState.employees[index] = {
                            ...AppState.employees[index],
                            name: name.toUpperCase(),
                            department,
                            designation,
                            contact
                        };
                    }
                } else {
                    // Add new
                    const newEmployee = {
                        id: AppState.employees.length > 0 ? 
                            Math.max(...AppState.employees.map(e => e.id)) + 1 : 1,
                        name: name.toUpperCase(),
                        department,
                        designation,
                        contact
                    };
                    AppState.employees.push(newEmployee);
                }
                
                AppState.saveData();
                UIController.updateEmployeesTable();
                UIController.updateEmployeeSelect();
                UIController.updateDashboardStats();
                document.getElementById('employeeModal').style.display = 'none';
                form.reset();
                
                UIController.showNotification(
                    id ? 'कर्मचारी अपडेट हो गया' : 'कर्मचारी जोड़ा गया',
                    'success'
                );
            },
            
            setupReportsHandlers() {
                document.querySelectorAll('.report-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const type = e.currentTarget.dataset.type;
                        this.generateReport(type);
                    });
                });
            },
            
            setupSettingsHandlers() {
                const saveBtn = document.getElementById('saveSettingsBtn');
                const resetBtn = document.getElementById('resetSettingsBtn');
                
                // Load current settings
                document.getElementById('languageSelect').value = AppState.settings.language;
                document.getElementById('startTime').value = AppState.settings.startTime;
                document.getElementById('endTime').value = AppState.settings.endTime;
                document.getElementById('enableNotifications').checked = AppState.settings.enableNotifications;
                document.getElementById('enableCamera').checked = AppState.settings.enableCamera;
                document.getElementById('enableLocation').checked = AppState.settings.enableLocation;
                
                saveBtn.addEventListener('click', () => {
                    AppState.settings = {
                        language: document.getElementById('languageSelect').value,
                        startTime: document.getElementById('startTime').value,
                        endTime: document.getElementById('endTime').value,
                        enableNotifications: document.getElementById('enableNotifications').checked,
                        enableCamera: document.getElementById('enableCamera').checked,
                        enableLocation: document.getElementById('enableLocation').checked
                    };
                    
                    AppState.saveSettings();
                    UIController.showNotification('सेटिंग्स सहेजी गईं', 'success');
                });
                
                resetBtn.addEventListener('click', () => {
                    if (confirm('क्या आप सेटिंग्स को डिफ़ॉल्ट पर रीसेट करना चाहते हैं?')) {
                        AppState.settings = {...CONFIG.DEFAULT_SETTINGS};
                        AppState.saveSettings();
                        
                        // Update UI
                        document.getElementById('languageSelect').value = AppState.settings.language;
                        document.getElementById('startTime').value = AppState.settings.startTime;
                        document.getElementById('endTime').value = AppState.settings.endTime;
                        document.getElementById('enableNotifications').checked = AppState.settings.enableNotifications;
                        document.getElementById('enableCamera').checked = AppState.settings.enableCamera;
                        document.getElementById('enableLocation').checked = AppState.settings.enableLocation;
                        
                        UIController.showNotification('सेटिंग्स रीसेट हो गईं', 'success');
                    }
                });
            },
            
            exportRecords() {
                const records = AppState.attendanceRecords;
                if (records.length === 0) {
                    UIController.showNotification('एक्सपोर्ट करने के लिए कोई डाटा नहीं', 'warning');
                    return;
                }
                
                const headers = ['कर्मचारी', 'विभाग', 'पदनाम', 'तारीख', 'समय', 'स्थिति', 'स्थान', 'IP पता', 'टिप्पणी'];
                const csvData = [
                    headers.join(','),
                    ...records.map(record => [
                        `"${record.name}"`,
                        `"${record.department}"`,
                        `"${record.designation}"`,
                        `"${record.date}"`,
                        `"${record.time}"`,
                        `"${record.status === 'present' ? 'उपस्थित' : 'अनुपस्थित'}"`,
                        `"${record.location}"`,
                        `"${record.ip}"`,
                        `"${record.comment || ''}"`
                    ].join(','))
                ].join('\n');
                
                const blob = new Blob([csvData], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                const url = URL.createObjectURL(blob);
                
                link.href = url;
                link.download = `अटेंडेंस_रिकॉर्ड_${new Date().toISOString().split('T')[0]}.csv`;
                link.click();
                URL.revokeObjectURL(url);
                
                UIController.showNotification('CSV फाइल डाउनलोड हो गई', 'success');
            },
            
            exportData() {
                const data = {
                    app: 'पंचायती राज विभाग AI अटेंडेंस सिस्टम',
                    version: CONFIG.APP_VERSION,
                    exportDate: new Date().toISOString(),
                    employees: AppState.employees,
                    attendanceRecords: AppState.attendanceRecords
                };
                
                const jsonData = JSON.stringify(data, null, 2);
                const blob = new Blob([jsonData], { type: 'application/json' });
                const link = document.createElement('a');
                const url = URL.createObjectURL(blob);
                
                link.href = url;
                link.download = `अटेंडेंस_डाटा_${Date.now()}.json`;
                link.click();
                URL.revokeObjectURL(url);
                
                UIController.showNotification('सभी डाटा डाउनलोड हो गया', 'success');
            },
            
            generateReport(type) {
                UIController.showNotification(`${type} रिपोर्ट जेनरेट की जा रही है...`, 'info');
                
                setTimeout(() => {
                    UIController.showNotification(`${type} रिपोर्ट डाउनलोड हो गई`, 'success');
                }, 2000);
            }
        };
        
        // ========== INITIALIZATION ==========
        function initApp() {
            // Hide loading screen after 1.5 seconds
            setTimeout(() => {
                document.getElementById('loadingScreen').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('loadingScreen').style.display = 'none';
                }, 500);
            }, 1500);
            
            // Initialize state and UI
            AppState.init();
            EventHandlers.init();
            
            // Get IP address
            fetch('https://api.ipify.org?format=json')
                .then(res => res.json())
                .then(data => {
                    AppState.currentIP = data.ip;
                })
                .catch(() => {
                    AppState.currentIP = 'N/A';
                });
        }
        
        // Start the application
        document.addEventListener('DOMContentLoaded', initApp);
        
        // Service Worker for PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .catch(err => console.log('Service Worker registration failed:', err));
            });
        }
    </script>
</body>
</html>